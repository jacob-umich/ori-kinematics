@startuml
scale 1200 width
state Structure {
    Uninitialized --> Initialized: Constructor
    Initialized --> Simulated: Simulate
    Simulated-->Simulated: repeat for defined timesteps
    Uninitialized: the object has not been defined

    state Initialized {
    [*] --> FileInMemory: FileLoaded
    
    FileInMemory --> BodiesDefined: ParseFile
    state BodiesDefined{
        [*] --> DefineNodes: Define body nodes from file
        DefineNodes --> NodesConnected: Define Edges
        DefineNodes: Define all nodes for a body
        NodesConnected:
    }
    FileInMemory --> TargetVelocitiesDefined: ParseFile
    BodiesDefined --> BodiesDefined: MoreBodies
    BodiesDefined --> BodiesConnected: organize nodes in a global sense
    BodiesConnected: This step will map shared nodes to the same coordinate
    TargetVelocitiesDefined: Define the velocity direction, magnitude, timestep, and number of steps
    }

    state Simulated {
        [*] --> MotionRestricted: Define Constraint Matrix
        MotionRestricted--> HasAcceptableVelocity: project target velocity
        HasAcceptableVelocity --> UpdatedPositions: Integrate velocities
        HasAcceptableVelocity --> OldPositionsStored: Store old positions for use later
        OldPositionsStored --> OldPositionsStored: Access Positions
    }
}

@enduml
